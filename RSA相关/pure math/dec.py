import gmpy2
from Crypto.Util.number import long_to_bytes

x1 = 1137973316343089029387365135250835133803975869258714714790597743585251681751361684698632609164883988455302237641489036138661596754239799122081528662395492
x2 = 6901383184477756324584651464895743132603115552606852729050186289748558760692261058141015199261946483809004373728135568483701274908717004197776113227815323
# (p+q) mod pq = p+q = x3
p_q = 16791287391494893024031688699360885996180880807427715700800644759680986120242383930558410147341340225420991368114858791447699399702390358184412301644459406
x4 = 63112211860889153729003401381621068190906433969243079543438386686621389392583849748240273643614258173423474299387234175508649197780206757067354426424570586101908571600743792328163163458500138799976944702155779196849585083397395750018148652864158388247163109077215394538930498877175474225571393901460434679279

# p*x1 +q*x2 = x4 mod pq
# q = (x4 - (p_q)*x1) / (x1 + x2) mod pq 且 q < pq
# 所以 q = (x4 - (p_q)*x1) / (x1 + x2)

if (x4 - x1 * p_q) % (x2 - x1) == 0:
    print('True')
q = (x4 - x1 * p_q) // (x2 - x1)
print(q)
p = p_q - q

c = 6931243291746179589612148118911670244427928875888377273917973305632621316868302667641610838193899081089153471883271406133321321416064760200919958612671379845738048938060512995550639898688604592620908415248701721672948126507753670027043162669545932921683579001870526727737212722417683610956855529996310258030

z = (p - 1) * (q - 1)
e = 31337
d = gmpy2.invert(e, z)
flag = gmpy2.powmod(c, d, p * q)
print(long_to_bytes(flag))
#flag = hex(flag)[2:]
#print (flag.decode('hex'))